# IAD_ML_approximation

This is a set of utils for analysing the [IAD algorithm](https://github.com/scottprahl/iad) of Scott Prahl.
It was created during my attempts to approximate IAD with machine learning. The repository has provides tools for quickly generating and analysing/plotting
the data produced with IAD or Monte Carlo for multilayered media ([MCML](https://omlc.org/software/mc/)) and using this data for training.

# Getting started

The central class of the project is data_processing/DIS_dataset.py. This structure contains the necessary data about an optical calculation: $\mu_a, \mu_s, g,
M_R, M_T$, thickness, convergence status of IAD, etc. It is important to be careful and distinguish quantities which are known only for successful IAD calculation
(such as $mu_a,mu_s$) and the ones which exist as input for any calculation including the unsuccessful ones. The number of values of each type is clearly different.
It is possible to extract the values corresponding only to the successful measurement by using  a view of the array at data.successful_indices.

The DIS_dataset extends PyTorch Dataset class, so it can be easily used with for PyTorch dataloaders. The class also allows to extract arrays for training
scikit-learn models with the method get_scipy_data.

The are some other important classes in the data_processing directory. generate_iad_data.py allows to run IAD on randomly generated $M_R,M_T$ values to
to produce a folder in Data which can then be used as a dataset. Similarly, generate_mcml_data.py runs MCML on randomly generated $\mu_a,\mu_s$. 
IAD_MCML_data.py applies IAD to a dataset generated by MCML. Comparing the two datasets gives an insight about the consistency of IAD (in the 0-sphere case)
and MCML. Obviously, in order to run the thing you need IAD and/or MCML installed. I have experienced some difficulties with compiling MCML (apparently there
are some mistakes with memory allocation in its code) so you can use the fixed version in this repo.
